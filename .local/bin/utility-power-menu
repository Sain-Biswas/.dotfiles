#! /usr/bin/env bash

command(){
    echo -e "POWEROFF\nREBOOT\nSUSPEND\nLOCK" | rofi -dmenu -theme ~/.dotfiles/.config/rofi/launcher.rasi -theme-str 'mainbox { children: ["listview"]; } window { width: 20%; } listview { scrollbar: false; lines: 2; columns: 2; } element-text { horizontal-align: 0.5; }' || exit 0
}

confirm(){
    echo -e "YES\nNO" | rofi -dmenu -theme ~/.dotfiles/.config/rofi/launcher.rasi -theme-str 'mainbox { children: ["listview"]; } window { width: 20%; } listview { scrollbar: false; lines: 1; columns: 2; } element-text { horizontal-align: 0.5; }' || exit 0
}

execute() {
	selected="$(confirm)"
	if [[ "$selected" == "YES" ]]; then
		if [[ $1 == '--shutdown' ]]; then
			systemctl poweroff
		elif [[ $1 == '--reboot' ]]; then
			systemctl reboot
		elif [[ $1 == '--suspend' ]]; then
			hyprlock -f || systemctl suspend
		fi
	else
		exit 0
	fi
}

choosen="$(command)"

echo "$choosen"

case ${choosen} in
    "POWEROFF")
		execute --shutdown
        ;;
    "REBOOT")
		execute --reboot
        ;;
    "LOCK")
		pidof hyprlock || hyprlock
        ;;
    "SUSPEND")
		execute --suspend
        ;;
esac
